---
title: å…¨å¹²å·¥ç¨‹å¸ˆï¼šåç«¯å·¥ç¨‹å¸ˆå…¥å‘å‰ç«¯æ€»ç»“
date: 2022-11-21 00:00:00
---

> ğŸŠ 2022 å¹´äº†ï¼Œä½œä¸ºä¸€ä¸ªåç«¯å·¥ç¨‹å¸ˆï¼Œå¦‚ä½•å…¥å‘å‰ç«¯ï¼Œæˆä¸ºå…¨å¹²ç¨‹å¸ˆã€‚ æœ¬æ–‡ä»¥åšä¸€ä¸ªå…±äº«è´­ç‰©è½¦çš„ Web ç«¯ä¸ºç›®æ ‡ï¼Œä»æ¡†æ¶é€‰å‹ï¼Œé…å¥—å·¥å…·é“¾ï¼Œç¼–ç¨‹è¯­è¨€è¯­æ³•ï¼ŒCSS æ ·å¼ç­‰ç­‰ï¼Œæ¶‰åŠåšä¸€ä¸ªå‰ç«¯é¡¹ç›®çš„æ–¹æ–¹é¢é¢ï¼Œå•¥éƒ½æ•´ä¸€ç‚¹ï¼Œå†æ¬¡å…¥å‘å‰ç«¯ï¼Œä»¥ä¸»è§‚è§†è§’æ€»ç»“ä¸€ä¸‹ã€‚

## **æ¡†æ¶åŠå·¥å…·é“¾é€‰å‹**

å…¶å®æˆ‘åœ¨å‡ å¹´ä¹‹å‰ä¹Ÿå…¥å‘è¿‡å‰ç«¯ï¼Œç”¨è¿‡ Angular å†™è¿‡ç”¨äºæ¥å£æµ‹è¯•çš„å·¥å…·ï¼Œä¹Ÿå› æ­¤è¢«é¢†å¯¼ä½œä¸º**å¹¸è¿å„¿**é€‰ä¸­ï¼Œå°†å·²æœ‰çš„ä¸€ä¸ªç”¨ Delphi å†™çš„é‡‘èåå°ç®¡ç†ç³»ç»Ÿæ¬åˆ°æµè§ˆå™¨ä¸Šã€‚Angular åœ¨å‰ç«¯ä¸‰é©¾é©¬è½¦(React/Vue/Angular)é‡Œé¢å¥½åƒä¸€ç›´ä¸å¤ªå—å¾…è§ï¼Œä½œä¸ºå·²ç»å¼ƒå‘çš„äººï¼Œä¸ªäººè¯„ä»·æ˜¯ Angular æ˜¯ä¸ºä¸ºæ¡†æ¶åŒºåˆ«äº React/Vue çš„ï¼Œé€‰æ‹©äº† Angularï¼Œä¹Ÿå³ç»‘å®šäº†ç›¸åº”çš„å·¥å…·é“¾ï¼Œè‡ªç”±åº¦ä¹Ÿä½å¾ˆå¤šï¼ŒåŒæ—¶ Angular ä¹Ÿå¼€ç®±å³ç”¨çš„é™„å¸¦ä¸€å¥—å®Œæ•´çš„å·¥ç¨‹å®è·µï¼Œæ²¡æœ‰ä»€ä¹ˆ Redux, Vuex ç­‰ç­‰ã€‚è¿™å¯¹æ–°æ‰‹å¿«é€Ÿå…¥é—¨å†™å‡ºå¯ä»¥ä¸Šçº¿çš„ç³»ç»Ÿè¿˜æ˜¯æœ‰å¥½å¤„çš„ï¼Œåå¤„åˆ™æ˜¯ `TOO HEAVY` äº†ï¼Œè¿è¡Œèµ·æ¥ä¹Ÿèƒ½æ˜æ˜¾æ„Ÿè§‰åˆ°å»¶è¿Ÿï¼Œæœ‰å¾ˆå¤šç°æˆçš„ç»„ä»¶å¯ä»¥ç”¨ï¼ŒåŒ…æ‹¬é˜´å½±çˆ±å¥½è€… **Material UI** ä¹Ÿç®—æ˜¯å®˜æ–¹å‡ºå“çš„ï¼Œä½†æ˜¯è¦è‡ªå®šä¹‰è¿™äº›ç»„ä»¶çš„é€»è¾‘æˆ–æ ¼å¼åŸºæœ¬ä¸Šå°±ä¸å¯èƒ½äº†ã€‚

ä¹‹å‰å¼ƒå‘ä¸»è¦çš„åŸå› æ˜¯å‰ç«¯å·¥å…·é“¾å¤ªåºæ‚äº†ï¼ŒåŒ…æ‹¬æµè§ˆå™¨ä»¤äººææƒ§çš„é€‚é…é—®é¢˜ï¼Œç¹å¤šçš„ JavaScript ç‰ˆæœ¬(ES5, ES6, ESnext, ES2015...)ï¼›ä¹Ÿæ•´å‡ºäº† Babel è¿™ç§å°†é«˜ç‰ˆæœ¬ JS è¯­æ³•ä»£ç ç¼–è¯‘æˆé€‚é…æ—§æµè§ˆå™¨çš„ä½ç‰ˆæœ¬è¿è¡Œç¯æ—¶çš„ç¼–è¯‘å™¨ï¼›ç”¨ polyfill é€‚é…ä¸åŒå‚å•†çš„æµè§ˆå™¨ï¼›è€Œ Node.js çš„åŒ…ç®¡ç†å·¥å…·å°±æœ‰ npm, pnpm, yarnï¼Œé…åˆ 960 ä¸‡å¹³æ–¹å…¬é‡Œçš„å±€åŸŸç½‘ï¼Œä¸‹è½½ä¾èµ–ç­‰ä¸ªåŠå°æ—¶ç„¶å **TIMEOUT** ä¹Ÿæ˜¯æ—¶ä¸æ—¶çš„äº‹ï¼Œé¡ºä¾¿åæ§½ä¸€ä¸‹ Node.js åŒ…çš„æµ·é‡å°æ–‡ä»¶ç®€ç›´æ˜¯æœºæ¢°ç¡¬ç›˜æ€æ‰‹ï¼›ä¹Ÿæœ‰å¤§ä½¬ `Anders Hejlsberg` å‘æ˜äº† TypeScript æ¥å…‹æœ JS åŠ¨æ€ç±»å‹çš„å®‰å…¨é—®é¢˜å’Œå¤§å‹å·¥ç¨‹çš„å¼€å‘æ•ˆç‡é—®é¢˜ï¼›åœ¨ CSS é¢„å¤„ç†å™¨é¢†åŸŸï¼Œä¹Ÿæœ‰è¯¸å¦‚ LESS, Sass, Stylus ç­‰å·¥å…·ï¼›æœ€å JS æ¨¡å—åŒ–ä¹Ÿæœ‰ CommonJS å’Œ ESModuleï¼Œè§†è¿è¡Œç¯å¢ƒå’Œ Node.js ç‰ˆæœ¬å†³å®šé‚£ç§æ–¹å¼å¯ç”¨æˆ–è€…æ··ç”¨ã€‚

æ­¤æ¬¡é‡æ–°å…¥å‘ï¼Œä¸»è¦æ˜¯æœ‰äº† [2022 å¹´ JavaScript å¼€å‘å·¥å…·çš„ç”Ÿæ€ï¼Œåˆ«å†ç”¨è¿‡æ—¶çš„æ¡†æ¶äº†ï¼](https://mp.weixin.qq.com/s?__biz=MzAxODE2MjM1MA==&mid=2651609107&idx=1&sn=1a9852c5b75c93a2cfe1cc75976fbc7e) è¿™ç¯‡æ–‡ç« ä½œä¸ºå‚è€ƒï¼Œè½»æ¾é€‰æ‹©äº† React.js + Next.js + TailwindCSS + axios ç­‰æ¥æ„å»ºåº”ç”¨ã€‚å¦ä¸€ä¸ªå‚è€ƒçš„æ˜¯ [Frontend Developer Roadmap](https://roadmap.sh/frontend)ï¼Œç”¨è·¯çº¿å›¾çš„æ–¹å¼è§£æ„äº†å‰ç«¯å¼€å‘çš„æ–¹æ–¹é¢é¢ï¼Œå¯¹äºå‰ç«¯çŸ¥è¯†æ¡†æ¶çš„æŸ¥æ¼è¡¥ç¼ºéå¸¸æœ‰å¸®åŠ©ã€‚

### **React.js**

ä¸Šæ¬¡å­¦ä¹  [React.js](https://reactjs.org/) å­¦åˆ°åœ¨ Class Component é‡Œé¢å†™ `this.deleteRow.bind(this, id)` è¿™ç§ä»£ç çš„æ—¶å€™å°±è¢«åŠé€€äº†ã€‚React 16.8 å¼•å…¥ [Hooks](https://reactjs.org/docs/hooks-intro.html) ä¹‹åï¼Œç®—æ˜¯æ¶ˆé™¤äº†è¿™ä¸ªæ‹…å¿§ ğŸ˜Ÿã€‚

### **Next.js**

[Next.js](https://nextjs.org/docs/getting-started) æ˜¯æ„å»ºåœ¨ React.js ä¸Šçš„å‰ç«¯å¼€å‘æ¡†æ¶ï¼Œé›†æˆäº†ç¼–è¯‘å™¨ï¼ŒCSS é¢„å¤„ç†ï¼Œè·¯ç”±ç­‰ç­‰ï¼Œå¤§å¤§ç®€åŒ–äº†å‰ç«¯å·¥ç¨‹åŒ–çš„é—®é¢˜ï¼ŒåŒæ—¶è¿˜å¼•å…¥äº† SSR, SSG ç­‰é«˜çº§ç‰¹æ€§ï¼›ä½¿å‰ç«¯åº”ç”¨ä¸å†ä»…ä»…æ˜¯è¿è¡Œåœ¨æµè§ˆå™¨ä¸Šé¢çš„å•é¡µé¢åº”ç”¨ï¼Œä¹Ÿå¯ä»¥æœ‰å¯¹åº”çš„åç«¯ï¼Œæœ€è¿‘æ¥æ¨å‡ºäº†å·ç§°æ¯” `WebPack` å¿« "**700å€**" çš„ TurboPackã€‚

### **TailwindCSS**

[Tailwind](https://tailwindui.com/) æä¾›ä¸€å¥—æ ‡å‡†çš„ï¼Œé£æ ¼ä¸€è‡´çš„ CSS æ ·å¼é›†åˆï¼Œå¯ä»¥å®Œå…¨ä¸å†™ä¸€è¡Œ CSS ä»£ç ï¼Œåªé€šè¿‡ class çš„ç»„åˆå®ç°çš„ä¸°å¯Œçš„è§†è§‰æ ·å¼ï¼›ä»æœ‰é™çš„é›†åˆä¸­é€‰å–å¯ç”¨çš„ `class name` ä¸€æ–¹é¢å¯ä»¥ä¿è¯é£æ ¼ä¸€è‡´ï¼Œå¦ä¸€æ–¹é¢å¯ä»¥æ–¹ä¾¿æ ·å¼çš„ç®¡ç†ï¼Œä¸è‡³äºåƒæ¯ä¸ªé¡µé¢å•ç‹¬å†™ä¸€ä¸ª CSS æ–‡ä»¶æ··ä¹±åˆ†æ•£ï¼Œå®šä¹‰å„ç§è¹©è„šçš„ class nameï¼›æœ€åï¼ŒTailwindCSS é…åˆ PostCSS å…·ï¼Œå¯ä»¥è‡ªåŠ¨æ‰«æé¡¹ç›®ä¸­ç”¨åˆ°çš„ `class name` è¾“å‡ºä¸€ä¸ªç”¨åˆ°çš„æ ·å¼é›†åˆ CSS æ–‡ä»¶ï¼Œå‡å°‘æ„å»ºäº§ç‰©çš„ä½“ç§¯ï¼Œæé«˜é¡µé¢åŠ è½½é€Ÿåº¦ã€‚

## **JavaScript & Node.js**

> æœ¬èŠ‚ä»‹ç»ä¸€äº›é¡¹ç›®ä¸­å¿…é¡»è¦ç†è§£åˆå®¹æ˜“è¢«å¿½ç•¥çš„åŸºæœ¬æ¦‚å¿µï¼Œå¯¼è‡´æ–°æ‰‹ï¼ˆæŒ‡æˆ‘ğŸ¥ºï¼‰åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¾ˆå®¹æ˜“çŸ¥å…¶ç„¶ï¼Œä¸çŸ¥å…¶æ‰€ä»¥ç„¶ã€‚

### **JavaScript Modules**

æœ€åˆç‰ˆæœ¬çš„ JavaScript è¢«è®¾è®¡æˆè¿è¡Œåœ¨æµè§ˆå™¨ä¸­ï¼Œé€šå¸¸æ˜¯å†…åµŒåœ¨ HTML é¡µé¢ä¸­çš„ `<script />` ä»£ç ï¼Œé€šè¿‡åŒæ­¥æˆ–å¼‚æ­¥çš„æ–¹å¼åŠ è½½ï¼Œå¹¶æ²¡æœ‰æ¨¡å—çš„æ¦‚å¿µï¼Œæ‰€æœ‰å˜é‡ï¼Œå¸¸é‡ï¼Œå‡½æ•°æ˜¯å…¨å±€å¯è§çš„ï¼›è¿™æ˜¾ç„¶é™åˆ¶äº†å‰ç«¯çš„å·¥ç¨‹åŒ–ã€‚å‚è€ƒæ–‡æ¡£ï¼š[CommonJS vs. ES Modules: Modules and Imports in NodeJS](https://reflectoring.io/nodejs-modules-imports/) .

#### **CommonJS Modules**

åœ¨ `CommonJS Module` æ¨¡å¼ä¸‹ï¼Œæ¯ä¸€ä¸ª `.js` æ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œé€šè¿‡ `module.exports` å¯¼å‡ºæ–‡ä»¶ä¸­çš„ `symbol`ï¼Œæ¢è¨€ä¹‹ï¼Œå…¶å®ƒéå¯¼å‡ºçš„å˜é‡ï¼Œå¸¸é‡ï¼Œå‡½æ•°ç­‰ï¼Œå¤–éƒ¨ä¸å¯ç›´æ¥å¼•ç”¨ã€‚

``` js
// file bar.js
const message = "Hello, world!"; // æ¨¡å—å¤–ä¸å¯è§
const greeting = () => {
    console.log(message);
}

module.exports = { greeting }; // å¯¼å‡ºå‡½æ•° bar
```

`module.exports` å¯ä»¥ç®€å†™æˆ `exports`ï¼Œå› æ­¤ `bar.js` ä¸­çš„å¯¼å‡ºè¡¨è¾¾å¼ä¹Ÿæœ‰å¯¹åº”çš„å†™æ³•ã€‚

``` js
#1
exports.greeting = greeting;
#2
exports.hello = greeting; // å°† greeting ä»¥ hello æˆ‘åå­—å¯¼å‡º
#3
exports = {
    hello: greeting, // ä¸ #2 ç­‰ä»·
}
```

é€šè¿‡ `require` å¯¼å…¥å…¶å®ƒæ¨¡å—

``` js
// file foo.js
const bar = require("bar"); // å¯¼å…¥ bar.js æ¨¡å—ï¼Œæ¨¡å—åä¸ºå»æ‰äº†åç¼€çš„æ–‡ä»¶å
bar.greeting();

const { greeting } = require("bar"); // ä»…å¯¼å…¥æŒ‡å®šçš„ symbol
```

å®é™…ä¸Šå¯ä»¥å°†ä»»æ„ç±»å‹èµ‹å€¼ç»™ `module.exports`ï¼Œå¦‚ `class`

``` js
// file bar.js
class Logger {
    static debug(message) {
        console.log("DEBUG", message);
    }
}

module.exports = Logger;

// file foo.js
const Logger = require("./bar");
Logger.debug("hello, world!");
```

[`Node.js`](https://nodejs.org/) é»˜è®¤æ”¯æŒ CommonJS Moduleï¼ŒJavaScript ECMAScript(ES2015) æ ‡å‡†åˆ¶å®šäº†æ ‡å‡†çš„æ¨¡å—åŒ–è§„èŒƒ `ES Module`.

#### **ES Modules**

ES Module ä¹Ÿæ˜¯ä»¥æ–‡ä»¶ä¸ºå•ä½ä½œä¸ºæ¨¡å—ï¼Œä¸ºäº†åŒºåˆ«äº `.js` æ–‡ä»¶é»˜è®¤ä½œä¸º CommonJS Module, è§„èŒƒå®šä¹‰ ES Module æ–‡ä»¶çš„åç¼€åä¸º `.mjs`ï¼Œå®é™…å®ç”¨ä¸€èˆ¬ä»ç”¨ `.js` åç¼€ï¼Œé€šè¿‡é…ç½®å¯è‡ªåŠ¨è¯†åˆ«æ–‡ä»¶ä½¿ç”¨çš„æ˜¯é‚£ç§ Module.

å°†å‰é¢çš„ Logger æ”¹é€ æˆ ES Module å¦‚ä¸‹ï¼Œ

``` js
// bar.mjs
export default class Logger {
    static debug(message) {
        console.log("DEBUG", message);
    }
}

// æ¨¡å—å¯ä»¥æœ‰ä¸€ä¸ª export defaultï¼Œä½†å¯ä»¥æœ‰å¤šä¸ªå…¶å®ƒ export 
export message = "Hello, world!";
export count = 42;

// ä¹Ÿå¯ä»¥é›†ä¸­å¯¼å‡º
export { message, count };
```

é€šè¿‡ import æ–¹å¼å¯¼å…¥ï¼Œ

``` js
// foo.mjs
import Logger, { message, count } from "./bar";
Logger.debug("hello, world!");
Logger.debug(count);
Logger.debug(message);

// å½“å¯¼å…¥å‘½åæœ‰å†²çªæ—¶ï¼Œä¹Ÿå¯ä»¥é‡å‘½åå¯¼å…¥
import { default as BarLogger, message as defaultMessage, count} from "./bar";

// å¯¼å…¥æˆæ¨¡å—
import * as bar "./bar";
Logger.debug(bar.message);
```

#### **Dynamic vs. Static**

CommonJS çš„ `requre()` å¯¼å…¥å‡½æ•°æ˜¯åœ¨è¿è¡Œæ—¶åŠ¨æ€è§£æå¯¼å…¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ `require()` å¯ä»¥åƒæ™®é€šçš„å‡½æ•°é‚£æ ·ä½¿ç”¨ï¼ŒæŒ‰éœ€è¦å¯¼å…¥ï¼Œè€Œ ES Module çš„ `import` æ˜¯é™æ€ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µå°±éœ€è¦ç¡®å®šå¯¼å…¥ä¾èµ–ï¼Œå› äº›åªèƒ½å‡ºç°çš„æ–‡ä»¶å¤´ã€‚

#### **index.js ä¸ç±»å‹æç¤º**

å‰é¢ä»‹ç»çš„æ¨¡å—å¯¼å…¥æ—¶ï¼Œéƒ½æ˜¯ä»¥æ–‡ä»¶åå»æ‰åç¼€ä½œä¸ºæ¨¡å—åï¼Œå®é™…ä¸Šä¹Ÿå¯ä»¥å°†æ–‡ä»¶å¤¹åä½œä¸ºæ¨¡å—åï¼ˆè¿™å¯èƒ½ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¯¼å…¥çš„æ—¶å€™ä¸åŠ æ–‡ä»¶ååç¼€çš„åŸå› å§ï¼‰

``` js
// å‡è®¾æœ‰æ–‡ä»¶å¤¹ server åŠå…¶ä¸­çš„æ–‡ä»¶å¦‚ä¸‹
// server
// â”œâ”€â”€ foo.js
// â”œâ”€â”€ bar.js
// â”œâ”€â”€ index.d.ts
// â””â”€â”€ index.js
// åˆ™å°† index.js ä½œä¸º server æ–‡ä»¶å¤¹çš„é»˜è®¤æ¨¡å—å¯¼å…¥å¦‚ä¸‹
import * as server from "./server";
```

è¿™ç§å¯¼å…¥æ–‡ä»¶å¤¹çš„æ–¹å¼æœ‰ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åœ°æ–¹åœ¨äºå¯ä»¥åœ¨æ–‡å¤¹ä¸­æ·»åŠ ä¸€ä¸ª index.d.ts ä½œä¸º index.js ä¸­å¯¼å‡ºç±»å‹çš„å®šä¹‰ [Declartion Reference](https://www.typescriptlang.org/docs/handbook/declaration-files/by-example.html)ï¼Œè¾…åŠ© IDEï¼ˆå¦‚ï¼šVSCodeï¼‰è¿›è¡Œç±»å‹æç¤ºï¼Œè€Œåˆä¸å¿…é‡‡ç”¨ `TypeScript`ï¼Œä½œä¸º JavaScript åŠ¨æ€ç±»å‹çš„è¡¥å……ã€‚å¦ä¸€æ–¹é¢ï¼Œä¹Ÿå¯ä»¥åœ¨é index.js æ–‡ä»¶ä¸­å®šä¹‰éå¯¼å‡ºç±»å‹ï¼Œç»Ÿä¸€åœ¨ index.js æ–‡ä»¶ä¸­å¯¼å‡ºï¼Œå°†æ–‡ä»¶å¤¹æ•´ä½“ä½œä¸ºä¸€ä¸ªæ¨¡å—ï¼Œå°±åƒ `package.json` ä¸­å¯¼å…¥çš„ä¾èµ–ä¸€æ ·ã€‚

æ³¨æ„ï¼šCommonJS Module ä¸­å¯ä»¥é€šè¿‡ import å‘½ä»¤è¢«å¯¼å…¥åˆ° ES Moduleï¼Œåä¹‹åˆ™ä¸è¡Œã€‚

### **package.json**

`package.json` æ˜¯ Node.js é¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œç”¨æ¥ç®¡ç†ä¾èµ–ï¼Œè„šæœ¬ï¼Œè¢«ä½œä¸ºåº“å¯¼å…¥æ—¶çš„å…¥å£ç­‰ã€‚

#### **script**

`npm run` å‘½ä»¤è¿è¡Œçš„è„šæœ¬ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª shell è„šæœ¬ï¼Œå¹¶å°†å½“å‰é¡¹ç›®ç›®å½•ä¸‹çš„ `node_modules/.bin` å­ç›®å½•åŠ å…¥åˆ° PATH å˜é‡ä¸­ï¼Œå› æ­¤åœ¨ `scripts` ä¸‹å¯ä»¥ç›´æ¥è°ƒç”¨ node_modules/bin ä¸‹çš„å‘½ä»¤ã€‚

``` json
{
    "scripts": {
        "build": "esbuild index.js"
        // ç­‰ä»·äº "build": "./node_modules/.bin/esbuild index.js"
        // ä½¿ç”¨ npm run build è§¦å‘
    }
}
```

#### **bin**

`bin` æŒ‡å®šäº†é¡¹ç›®ä½œä¸º npm åŒ…çš„æ‰§è¡Œå…¥å£ï¼Œå½“é¡¹ç›®ä½œä¸ºåŒ…è¢«å®‰è£…åˆ°å…¨å±€æˆ–å…¶å®ƒé¡¹ç›®æ—¶ï¼Œä»¥å‘½ä»¤çš„æ–¹å¼æ‰§è¡Œçš„å…¥å£è„šæœ¬æ–‡ä»¶ã€‚å¦‚ï¼š@bytepack/cli çš„ npm åŒ…ï¼Œ

``` json
{
    "bin": {
        "bytepack": "./bin/index.js"
    }
}
```

å…¨å±€å®‰è£… @bytepack/cli åŒ…åï¼Œæ‰§è¡Œ `bytepack -v` å‘½ä»¤å°±ç›¸å½“äºæ‰§è¡Œ `node ./bin/index.js -v` å‘½ä»¤ã€‚

#### **type**

`type` æŒ‡å®šé¡¹ç›®çš„æ¨¡å—åŒ–è§„èŒƒ

``` json
{
    "name": "some package",
    "type": "module" || "commonjs"
}
```

éœ€è¦æ³¨æ„çš„æ˜¯ï¼š

- ä¸æŒ‡å®štypeçš„æ—¶å€™ï¼Œtype çš„é»˜è®¤å€¼æ˜¯ commonjsï¼Œä¸è¿‡å»ºè®® npm åŒ…éƒ½æŒ‡å®šä¸€ä¸‹ type
- å½“ type å­—æ®µæŒ‡å®šå€¼ä¸º module åˆ™é‡‡ç”¨ ESModule è§„èŒƒ
- å½“ type å­—æ®µæŒ‡å®šæ—¶ï¼Œç›®å½•ä¸‹çš„æ‰€æœ‰ .js åç¼€ç»“å°¾çš„æ–‡ä»¶ï¼Œéƒ½éµå¾ª type æ‰€æŒ‡å®šçš„æ¨¡å—åŒ–è§„èŒƒ
- é™¤äº† type å¯ä»¥æŒ‡å®šæ¨¡å—åŒ–è§„èŒƒå¤–ï¼Œé€šè¿‡æ–‡ä»¶çš„åç¼€æ¥æŒ‡å®šæ–‡ä»¶æ‰€éµå¾ªçš„æ¨¡å—åŒ–è§„èŒƒï¼Œä»¥ .mjs ç»“å°¾çš„æ–‡ä»¶å°±æ˜¯ä½¿ç”¨çš„ ESModule è§„èŒƒï¼Œä»¥ .cjs ç»“å°¾çš„éµå¾ªçš„æ˜¯ commonjs è§„èŒƒ

#### **expports**

å¦‚æœåœ¨package.jsonä¸­å®šä¹‰äº†exportså­—æ®µï¼Œé‚£ä¹ˆè¿™ä¸ªå­—æ®µæ‰€å®šä¹‰çš„å†…å®¹å°±æ˜¯è¯¥npmåŒ…çš„çœŸå®å’Œå…¨éƒ¨çš„å¯¼å‡ºï¼Œä¼˜å…ˆçº§ä¼šé«˜äºmainå’Œfileç­‰å­—æ®µã€‚

ä¸¾ä¾‹æ¥è¯´ï¼š

``` json
{
Â Â "name":Â "pkg",
Â Â "exports":Â {
Â Â Â Â ".":Â "./main.mjs",
Â Â Â Â "./foo":Â "./foo.js"
Â Â }
}
```

``` js
importÂ {Â somethingÂ }Â fromÂ "pkg";Â //Â fromÂ "pkg/main.mjs"
```

``` js
constÂ {Â somethingÂ }Â =Â require("pkg/foo");Â //Â require("pkg/foo.js")
```

#### **peerDependenceis**

peerDependenciesæ˜¯package.jsonä¸­çš„ä¾èµ–é¡¹,å¯ä»¥è§£å†³æ ¸å¿ƒåº“è¢«ä¸‹è½½å¤šæ¬¡ï¼Œä»¥åŠç»Ÿä¸€æ ¸å¿ƒåº“ç‰ˆæœ¬çš„é—®é¢˜ã€‚

#### **package.jsonä¸‰æ–¹å±æ€§**

package.jsonä¸­ä¹Ÿå­˜åœ¨å¾ˆå¤šä¸‰æ–¹å±æ€§ï¼Œæ¯”å¦‚tscä¸­ä½¿ç”¨çš„typesã€æ„å»ºå·¥å…·ä¸­ä½¿ç”¨çš„sideEffects,gitä¸­ä½¿ç”¨çš„huskyï¼Œeslintä½¿ç”¨çš„eslintIgnoreï¼Œè¿™äº›æ‰©å±•çš„é…ç½®ï¼Œé’ˆå¯¹ç‰¹å®šçš„å¼€å‘å·¥å…·æ˜¯æœ‰æ„ä¹‰çš„è¿™é‡Œä¸ä¸€ä¸€ä¸¾ä¾‹ã€‚

æ›´å¤šé…ç½®å‚è€ƒï¼š[package.json é…ç½®ä»‹ç»](https://mp.weixin.qq.com/s/91uQb5NKpINgdTEF9L0eMQ).

### **Local Storage vs. Session Storage vs. Cookie**

ç®€å•ä»‹ç»æµè§ˆå™¨ç«¯çš„å­˜å‚¨çš„é€‰æ‹©ï¼Œæ‰€æœ‰çš„å­˜å‚¨éƒ½æ˜¯èŒƒå›´éƒ½æ˜¯é™å®šåŸŸåä¸‹é¢çš„ï¼Œå³ï¼š`a.com` åŸŸåçš„å­˜å‚¨ä¸èƒ½è¢« `b.com` åŸŸåçš„ä»£ç è¯»å–åˆ°ã€‚å‚è€ƒæ–‡æ¡£ï¼š[Local Storage vs Session Storage vs Cookie](https://www.xenonstack.com/insights/local-vs-session-storage-vs-cookie).

#### **Local Storage**

Local Storage ä¸­å­˜å‚¨çš„å†…å®¹æ˜¯æŒä¹…çš„ï¼Œå…³é—­é¡µé¢æˆ–æµè§ˆå™¨ä¸ä¼šæ¸…é™¤å…¶ä¸­çš„å†…å®¹ï¼Œé€šè¿‡ JavaScript ä»£ç è¿›è¡Œæ“ä½œã€‚

``` js
localStorage.setItem(key, value);
localStorage.getItem(key);
localStorage.removeItem(key);
localStorage.clear();
```

Key å’Œ Value å‡ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œå› æ­¤å­˜å‚¨å‰éœ€è¦å…ˆå°†æ•°æ®åºåˆ—åŒ–ï¼Œæœ€å¤šå¤§æ¦‚å¯å­˜å‚¨ 10MBã€‚

#### **Session Storage**

Session Storage ä¸ Local Storage ç±»ä¼¼ï¼Œå”¯ä¸€çš„ä¸åŒåœ¨äºå®ƒç”Ÿå‘½å‘¨æœŸæ¯”è¾ƒçŸ­ï¼Œå½“æµè§ˆå™¨ Tab é¡µå…³é—­æ—¶ï¼ŒSession Storage ä¸­çš„å†…å®¹æ¸…é™¤ï¼Œæœ€å¤šå¤§æ¦‚å¯å­˜å‚¨ 5MBã€‚

``` js
sessionStorage.setItem(key, value);
sessionStorage.getItem(key);
```

Session Storage ä¸€èˆ¬ç”¨ä¸åˆ°ï¼Œé™¤éç”¨æ¥åšé¡µé¢çº§åˆ«çš„æ§åˆ¶ã€‚

#### **Cookie**

Cookie å­˜å‚¨çš„ä¸€èˆ¬æ˜¯å½¢å¦‚ `a=foo;b=bar;token=xxx` çš„è¡¨å•æ•°æ®ï¼Œå½“ç”¨æˆ·ç‚¹å‡»é“¾æ¥æˆ–æµè§ˆå™¨è‡ªåŠ¨è·³è½¬æ—¶è¯·æ±‚åç«¯æœåŠ¡å™¨æ—¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨åœ¨è¯·æ±‚å¤´ä¸­å¸¦ä¸ŠåŸŸåå¯¹åº”çš„ Cookie å†…å®¹è€Œä¸éœ€è¦ä»»ä½• Cliet-Side JavaScript åšæ“ä½œï¼Œç›¸æ¯” Local/Session Storage æ–¹ä¾¿ï¼Œå½“ç„¶æ¯ä¸ªè¯·æ±‚éƒ½æºå¸¦ Cookie ä¸å¯é¿å…åœ°é€ æˆå¸¦å®½æµªè´¹ã€‚

Cookie å†…å®¹å¯ä»¥ç”±åç«¯æœåŠ¡åœ¨è¿”å›è¯·æ±‚å¤´ä¸­è®¾ç½®ï¼Œå¦‚ç”¨æˆ·ç™»å½• `a.com` åŸŸååï¼ŒæœåŠ¡ç«¯çš„å“åº” Header ä¸­åŒ…å« `Set-Cookie: token=xxx`ï¼Œæµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åå°±ä¼šè‡ªåŠ¨è®¾ç½® Cookie è€Œä¸éœ€è¦ JavaScript ä»£ç æ“ä½œï¼›åŒæ—¶ï¼Œä¸ºäº†é˜²æ­¢æ¶æ„ä»£ç è·å–ç¬¬ä¸‰æ–¹ Cookieï¼Œå¯ä»¥åœ¨å“åº”å¤´ä¸­å¢åŠ  `HttpOnly` æ¥é˜²æ­¢ JavaScript ä»£ç è¯»å– Cookie å†…å®¹ï¼Œå¦‚ï¼š`Set-Cookie: token=xxx;HttpOnly`ï¼Œç”±æµè§ˆå™¨å®ç°ä¿è¯å®‰å…¨æ€§ï¼Œä¹Ÿå¯ä»¥è®¾ç½®å¤±æ•ˆæ—¶é—´ï¼Œè¿‡æœŸå†…å®¹è‡ªåŠ¨é”€æ¯ã€‚

Cookie çš„ç¼ºç‚¹ï¼Œç¬¬ä¸‰æ–¹ Cookie å¯èƒ½è¢«ç›—ç”¨ï¼Œå­˜å‚¨æœ€å¤š 4KB æ•°æ®ï¼Œåªå­˜å‚¨äºæµè§ˆå™¨ï¼Œåœ¨å°ç¨‹åºç­‰ç¯å¢ƒåªæœ‰æ²¡æœ‰ Cookieã€‚

æ›´å¤šé€‰é¡¹ï¼š

``` plain
Set-Cookie: <name>=<value>[; <Max-Age>=<age>]
[; expires=<date>][; domain=<domain_name>]
[; path=<some_path>][; secure][; HttpOnly]
```

### **å·¥å…·é“¾é€‰æ‹©**

#### **åŒ…ç®¡ç†å·¥å…· pnpm**

pnpm æ¯” npm æ›´èŠ‚çœç£ç›˜ç©ºé—´ï¼Œyarn å¼€å§‹è¢«æŠ›å¼ƒï¼Œç›¸å…³ç¯å¢ƒå˜é‡, [npm vs yarn vs pnpm commands cheatsheet](https://dev.to/equiman/npm-vs-yarn-vs-pnpm-commands-cheatsheet-3el8).

``` bash
export PNPM_HOME=$DEVKIT/.pnpm
export PATH=$PATH:$PNPM_HOME
```

#### **ç¼–è¯‘å·¥å…· swc**

swc: [Speedy Web Compiler](https://swc.rs/)ï¼Œç”¨ Rust å¼€å‘çš„æå¿«çš„ JS/TS ç¼–è¯‘å™¨ï¼Œéœ€è¦ tsc è¡¥å……é™æ€ç±»å‹æ£€æŸ¥ï¼Œæ”¯æŒ Next.js, Vercel, Deno çš„ç»„ä»¶ï¼Œå…·å¤‡ä¸€å®šçš„æ‰“åŒ…èƒ½åŠ›ï¼ŒNext.js ç›´æ¥é›†æˆäº† swcï¼Œæ— éœ€é…ç½®ã€‚å®˜æ–¹ä»‹ç»ï¼š
`SWC can be used for both compilation and bundling. For compilation, it takes JavaScript / TypeScript files using modern JavaScript features and outputs valid code that is supported by all major browsers.`

> **SWC is 20x faster than Babel on a single thread and 70x faster on four cores.**

#### **æ‰“åŒ…å·¥å…· WebPack**

æ‰“åŒ…å™¨è´Ÿè´£å°†æ‰€æœ‰çš„æºæ–‡ä»¶æ‰“åŒ…åˆ°ä¸€èµ·ï¼Œç”¨äºæ‰“åŒ…ç¬¬ä¸‰æ–¹åº“å’Œ Web åº”ç”¨ï¼š

- swc å’Œ esbuild æä¾›äº†åŸºæœ¬çš„æ‰“åŒ…èƒ½åŠ›ï¼Œä½†ä¸æ‰“åŒ…å™¨ç›¸æ¯”åŠŸèƒ½ä¸å…¨é¢
- Rollup åªæ”¯æŒç¬¬ä¸‰æ–¹åº“æ‰“åŒ…ï¼ŒParcel åªæ”¯æŒ swc ç¼–è¯‘å™¨
- **WebPack** æ”¯æŒ Web åº”ç”¨å’Œç¬¬ä¸‰æ–¹åº“æ‰“åŒ…ï¼Œæ”¯æŒ swc, tsc

#### **VSCode æ’ä»¶**

- **VSCode React Refactor**
- **ESLint**
- **Prettier ESLint**
- **Code Spell Checker**
- **ES7+ React/Redux/React-Native snippets**
- **Tailwind CSS Intellisense**
- **Emmet**
- **Prettier**
- **Auto rename tag**

å°ç»“ï¼šçœ‹å®Œå‰ç«¯çš„é“ºå«å¦‚æœè¿˜å¥åœ¨çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åŠ¨æ‰‹åˆ›å»ºåˆ›å»ºä¸€ä¸ª Next.js å·¥ç¨‹å¼€å§‹æ•´ä¸€ä¸ª Web ç«¯å…±äº«è´­ç‰©è½¦é¡¹ç›®äº†ã€‚

### **React.js & Next.js**

é¦–å…ˆç”¨ pnpm åˆ›å»ºä¸€ä¸ª Next.js å·¥ç¨‹ï¼Œè¯­è¨€æ–¹é¢ï¼Œä¸å¯ç”¨ TypeScriptï¼Œæˆ‘ä»¬åªéœ€è¦ `index.d.ts` ç±»å‹å£°æ˜æ¥è¾…åŠ© IDE åšä»£ç æç¤ºå°±å¤Ÿäº†ï¼Œä¸€æ–¹é¢ï¼Œç½‘ä¸Šçš„ç¤ºä¾‹ä»£ç ç»å¤§å¤šæ•°æ˜¯ JavaScriptï¼Œå¦ä¸€æ–¹é¢ï¼ŒTypeScript å¯¹äºåˆå­¦è€…æ¥è¯´æ”¶ç›Šç›¸å¯¹äºä»˜å‡ºçš„å­¦ä¹ æˆæœ¬ä¸åŒ¹é…ã€‚

``` bash
pnpm create next-app
```

é€‰æ‹©äº† Next.jsï¼Œä¹Ÿå°±é€‰æ‹©äº† swc, WebPack ç­‰ï¼ŒåŒæ—¶ä¹Ÿå¯æ—¶æ— ç¼é›†æˆ [TailwindCSS](https://tailwindcss.com/docs/guides/nextjs).

å‚è€ƒæ–‡æ¡£ï¼š[Create Next App](https://nextjs.org/docs/api-reference/create-next-app).

Next.js å®˜æ–¹æä¾›äº†éå¸¸å‹å¥½çš„æ–‡æ¡£ï¼Œå¯ä»¥ç›´æ¥å‚è€ƒï¼Œ[Getting Start](https://nextjs.org/docs/getting-started)ã€‚

#### **æœåŠ¡ç«¯æ¸²æŸ“ SSR**

ä¼ ç»Ÿçš„ Web App (Angular/React/Vue) æ˜¯å°†é¡¹ç›®æ‰“åŒ…æˆ JS/CSS/HTML ç­‰ç­‰é™æ€èµ„æºï¼Œæ”¾åˆ°é™æ€èµ„æºæœåŠ¡å™¨ä¸­ä¾›æµè§ˆå™¨è¯·æ±‚ï¼Œç”¨æˆ·åœ¨æµè§ˆå™¨ç«¯è®¿é—® Web App æ—¶å…ˆè¯·æ±‚ HTML/CSS/JS ç­‰é™å¤ªèµ„æºï¼Œæµè§ˆå™¨è·å–åˆ°é™æ€èµ„æºåï¼Œå†è¿è¡Œ JS ä»£ç è®¿é—®åç«¯æ¥å£è·å–åŠ¨æ€çš„æ•°æ®ï¼ˆå¦‚ï¼šç”¨æˆ·ä¸ªäººæ•°æ®ç­‰ï¼‰æœ€ç»ˆæ¸²æŸ“æˆé¡µé¢å‘ˆç°ç»™ç”¨æˆ·ã€‚

Next.js åœ¨ä¼ ç»Ÿ Web App çš„åŸºç¡€ä¸Šæä¾›äº† Server-Side Rendering(SSR)ï¼Œå³ Next.js åº”ç”¨æ˜¯ä½œä¸ºåç«¯æœåŠ¡å™¨è¿è¡Œçš„ï¼Œç”¨æˆ·è¯·æ±‚é¡µé¢æ—¶ï¼ŒNext.js åç«¯åº”ç”¨å¯ä»¥å…ˆè¿è¡Œ JS ä»£ç ï¼Œæ¸²æŸ“æˆ HTML/CSS ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯æµè§ˆå™¨è·å¾—å“åº”åå³å¯ç›´æ¥å‘ˆç°ç»™ç”¨æˆ·ï¼Œä¸ç”¨äºŒæ¬¡è¯·æ±‚ã€‚æ›´å¤šå…³äº SSR çš„ä¼˜ç¼ºç‚¹ç‚¹å¯ä»¥å‚è€ƒï¼š[getServerSideProps](https://nextjs.org/docs/basic-features/data-fetching/get-server-side-props).

#### **é™æ€ç½‘ç«™ç”Ÿæˆ SSG**

Static Site Generation(SSG) è¿›ä¸€æ­¥åœ°å°†é¡µé¢ç”Ÿæˆå‰ç½®åˆ°ç¼–è¯‘é˜¶æ®µï¼Œå…è®¸ç”¨æˆ·å®šä¹‰ `getStaticProps()` å‡½æ•°ï¼Œåœ¨ç¼–è¯‘çš„æ—¶å€™è¿è¡Œå¾—åˆ°ä¸é¡µé¢æ¸²æŸ“ç›¸å…³çš„æ•°æ®ï¼Œä»è€Œæ”¹å˜ç¼–è¯‘ç”Ÿæˆé¡µé¢ï¼Œå¯¹äºæœç´¢å¼•æ“ç´¢å¼•æ¯”è¾ƒæœ‰ç”¨ï¼Œå‚è€ƒï¼š[getStaticProps](https://nextjs.org/docs/basic-features/data-fetching/get-static-props).

#### **Next.js é¡¹ç›®ç»“æ„**

``` bash
my-app
â”œâ”€â”€ next.config.js    # é¡¹ç›®é…ç½®æ–‡ä»¶
â”œâ”€â”€ node_modules
â”œâ”€â”€ package.json
â”œâ”€â”€ components        # å¯ä»¥å¤ç”¨ React ç»„ä»¶
â”œâ”€â”€ lib               # é¡¹ç›®å†… JavaScript åº“ï¼Œå¦‚å°è£…è°ƒç”¨åç«¯çš„æ¥å£
â”œâ”€â”€ pages             # pages æ¯ä¸ªéä¸‹åˆ’çº¿å¼€å¤´çš„æ–‡ä»¶å¯¹åº”ä¸€ä¸ªé¡µé¢æˆ– APIï¼Œç›®å½•ç»“æ„ä¸æµè§ˆå™¨åœ°å€è·¯å¾„å¯¹åº”
â”‚   â”œâ”€â”€ api
â”‚   â”‚   â””â”€â”€ hello.js  # åç«¯ apiï¼Œå¯ä»¥é€šè¿‡ /api/hello è®¿é—®åˆ° hello.js ä¸­çš„å‡½æ•°
â”‚   â”œâ”€â”€ _app.js       # æ‰€æœ‰çš„é¡µé¢éƒ½ä¼šé€šè¿‡è¿™ä¸ªæ¸²æŸ“ï¼Œå¯ä»¥åœ¨è¿™é‡ŒåŠ é¡¹ç›®å…¨å±€çš„ä»£ç ï¼Œå¦‚ï¼šç™»å½•æ£€æŸ¥ï¼Œå¤œé—´æ¨¡å¼
â”‚   â””â”€â”€ index.js      # åº”ç”¨çš„ä¸»é¡µé¢ï¼Œå³è®¿é—® http://localhost:3000 çœ‹åˆ°çš„é¡µé¢
â”œâ”€â”€ pnpm-lock.yaml
â”œâ”€â”€ public
â”‚   â”œâ”€â”€ favicon.ico
â”‚   â””â”€â”€ vercel.svg
â”œâ”€â”€ README.md
â””â”€â”€ styles
    â”œâ”€â”€ globals.css   # å…¨å±€ CSS å½±å“æ‰€æœ‰ç»„ä»¶ï¼ŒTailwindCSS åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å¯¼å…¥æ ·å¼
    â””â”€â”€ Home.module.css # è¢« /pages/index.js å¯¼å…¥
```

å…³äº Next.js çš„è·¯ç”±ï¼Œå¯ä»¥å‚è€ƒï¼š[Routing](https://nextjs.org/docs/routing/introduction).

#### **ä¸Šä¸‹æ–‡èœå•**

åœ¨æµè§ˆå™¨ï¼Œå®ç°ä¸Šä¸‹æ–‡èœå•å¹¶ä¸æ˜¯å¾ˆç›´è§‚ï¼Œå®é™…ä¸Šåªæ˜¯æ¨¡æ‹Ÿä¼  UI çš„ä¸Šä¸‹æ–‡èœå•çš„æ“ä½œã€‚åŸºæœ¬çš„ HTML å…ƒç´ æ¸²æŸ“éƒ½æ˜¯é¡ºåºé“ºå¼€çš„ï¼Œè€Œä¸Šä¸‹æ–‡èœå•ï¼Œéœ€è¦æ˜¾ç¤ºçš„æ—¶å€™è¦†ç›–åœ¨ç°æœ‰çš„å…ƒç´ ä¹‹ä¸Šï¼ŒåŒæ—¶ç‚¹å‡»èœå•å¤–çš„åŒºåŸŸéšè—èœå•ã€‚å› æ­¤ï¼Œéœ€è¦ç”¨åˆ° CSS ä¸­çš„ `position: absolute` æ¥è®¾ç½®å…ƒç´ çš„ä½ç½®ä¸ºç»å¯¹ï¼ŒåŒæ—¶è¾…åŠ© `left, right, top, bottom` æ¥æŒ‡å®šå…ƒç´ çš„ä½ç½®ï¼Œä¸Šä¸‹å·¦å³çš„å‚è€ƒåæ ‡ä¸ºå…ƒç´ çš„æœ€è¿‘ä¸€ä¸ª `position: relative` å…ƒç´ ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š

``` js
import React from "react";

function CreatedBy({ cart, onAction }) {
  const [toggle, setToggle] = React.useState(false);
  const onToggle = () => {
    setToggle(toggle => !toggle);
  };
  return (
    <div className="inline-block">
      <span onClick={onToggle}
        className={`relative cursor-pointer bg-gray-300 rounded-full px-3 py-1 m-1 whitespace-nowrap text-sm font-semibold 
        ${toggle && "before:z-40 before:fixed before:block before:cursor-default before:top-0 before:left-0 before:bottom-0 before:right-0"}`}>
        by ME
      </span>
      <div className={`absolute z-50 ${toggle ? "block" : "hidden"}`}>
        <div className="flex flex-col w-fit py-2 shadow-lg rounded-lg mb-2 bg-gray-100 bg-opacity-95">
        <span className="inline-block cursor-pointer px-6 py-2 hover:bg-gray-200 text-sm font-semibold text-green-700"
            onClick={onToggle}>
            é‚€è¯·
        </span>
        <span className="inline-block cursor-pointer px-6 py-2 hover:bg-gray-200 text-sm font-semibold text-red-500"
            onClick={onToggle}>
            åˆ é™¤
        </span>
        </div>
      </div>
    </div>
  );
}

export default CreatedBy;
```

- ä½¿ç”¨ React Hook `React.useState(false)` æ¥ç®¡ç†èœå•çš„æ˜¾ç¤º(true)ä¸éšè—(false)
- ä½¿ç”¨ä¼ªå…ƒç´ åˆ›å»ºä¸€ä¸ªè¦†ç›–æ•´ä¸ªé¡µé¢çš„åŒºåŸŸç”¨æ¥æ¥æ”¶éšè—èœå•äº‹ä»¶ before:z-40 before:fixed before:block before:cursor-default before:top-0 before:left-0 before:bottom-0 before:right-0
- é€šè¿‡ä¿®æ”¹ div çš„ display å±æ€§ä¸º block/none(hidden) æ¥æ§åˆ¶ä¸Šä¸‹æ–‡èœå•çš„æ˜¾ç¤º `className={`absolute z-50 ${toggle ? "block " : "hidden"}`}`

![ä¸Šä¸‹æ–‡èœå•](../images/context_menu_show.png)

#### **å…¨å±€ä¸Šä¸‹æ–‡èœå•**

CartCart å…±äº«è´­ç‰©è½¦åœ¨å¯¼èˆªæ çš„ä¸­é—´æœ‰ä¸€ä¸ª Logo ä½œä¸ºå…¨å±€æŒ‰é’®ï¼Œå¯¼èˆªæ åœ¨ Web App çš„ä»»æ„é¡µé¢éƒ½å¯è§ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸åŒé¡µé¢æŒ‰è¿™ä¸ªæŒ‰é’®éƒ½æ ¹æ®å½“å‰é¡µé¢æ¥æ˜¾ç¤ºä¸åŒçš„ä¸Šä¸‹æ–‡èœå•ï¼ˆå¦‚åœ¨è´­ç‰©è½¦åˆ—è¡¨é¡µé¢å‡ºç°æ–°å»ºè´­ç‰©ç”»èœå•ï¼Œåœ¨å•†å“åˆ—è¡¨é¡µé¢å‡ºç°æ·»åŠ å•†å“èœå•ï¼‰ï¼Œæˆ–è€…ç›´åœ¨ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™è·³è½¬é¡µé¢ã€‚æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š

![æ— èœå•](../images/cartcart_carter_hidden.png)
![æ·»åŠ å•†å“èœå•](../images/cartcart_new_item.png)
![æ·»åŠ è´­ç‰©è½¦èœå•](../images/cartcart_new_cart.png)


è¿™ä¸ªåŠŸèƒ½å¯ä»¥åˆ©ç”¨ React çš„ [Context](https://reactjs.org/docs/context.html) åŠŸèƒ½æ¥å®ç°ã€‚

é¦–å…ˆå®šä¹‰ Context Provider å³è¿™ä¸ªå…¨å±€æŒ‰é’®ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸åŒé¡µé¢æ„ŸçŸ¥åˆ°è¿™ä¸ªæŒ‰é’®è¢«ç‚¹å‡»äº†ï¼ŒåŒæ—¶æˆ‘ä»¬åœ¨ä¸åŒé¡µé¢æ“ä½œå®Œæˆä¹‹åï¼Œéœ€è¦å›è°ƒå‘Šè¯‰ Context Providerã€‚

``` js
import Image from "next/image";
import React from "react";

function Carter() {
  const { toggle, setToggle } = useCarter();
  return (
    <>
      <div onClick={() => { setToggle(toggle => !toggle); }}>
        <div className={(toggle ? "before:z-40 before:fixed before:block before:top-0 before:left-0 before:bottom-0 before:right-0 " : "")} />
        <div className={"cursor-pointer w-8 h-8 transition-transform " + (toggle ? "rotate-45" : "")}>
          <Image width="32" height="32" alt="CartCart" src="/cartcart.svg" priority={true} ></Image>
        </div>
      </div>
    </>
  );
}

const CarterContext = React.createContext(null);

function CarterProvider(props) {
  const [toggle, setToggle] = React.useState(false);
  return (
    <CarterContext.Provider value={{ toggle, setToggle }} {...props} />
  );
}

function CarterPopup({ toggle, children }) {
  return (
    <div className={"max-w-sm fixed z-50 left-1/2 -translate-x-1/2 top-12 " + (toggle ? "block" : "hidden")}>
      {children}
    </div>
  );
}

const useCarter = () => React.useContext(CarterContext);

export default Carter;
export { CarterProvider, CarterPopup, useCarter };
```

å°† Context æ³¨å…¥åˆ° `_app.js` ä¸Šä¸‹æ–‡ä¸­ï¼Œå‰é¢æåˆ°æ‰€æœ‰çš„é¡µé¢éƒ½ä¼šé€šè¿‡è¿™ä¸ªæ–‡ä»¶çš„å‡½æ•°æ¸²æŸ“ã€‚

``` js
function CartCartApp({ Component, pageProps }) {
  return (
    <>
      <Head>
        <title>CartCart</title>
      </Head>
      <div className="flex flex-col items-center" >
          <CarterProvider>
            <NavBar />
            <Component {...pageProps} />
          </CarterProvider>
      </div>
    </>
  );
}

export default CartCartApp;
```

åœ¨ä¸åŒé¡µé¢ä¸­é€šè¿‡ useCarter ç›‘å¬å…¨å±€æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ã€‚

``` js

const CartPage = () => {
  const { toggle, setToggle } = useCarter();
  return (
    <>
      {
        toggle &&
        <CarterPopup toggle={toggle}>
          {å…¨å±€ä¸Šä¸‹æ–‡èœå•å†…å®¹}
        </CarterPopup>
      }
    </>
  );
};
```

#### **é¡µé¢å»¶è¿Ÿæ›´æ–°**

åœ¨é¡µé¢éœ€è¦ä»åç«¯åŠ¨æ€åŠ è½½æ•°æ®è¿›è¡Œæ¸²æŸ“æˆ–å®šæ—¶åˆ·æ–°æ—¶ï¼Œéœ€è¦ç”¨åˆ° `React.useEffect()` Hook å‡½æ•°ã€‚å•çº¯ç”¨ async å‡½æ•°æˆ– `setInterval()` ç­‰å‡½æ•°æ˜¯æ— æ³•åœ¨ React Functional Component ä¸­è§¦å‘ç»„ä»¶æ›´æ–°çš„ã€‚

å¦‚ä¸‹è·¯ç”±åˆ°å•†å“åˆ—è¡¨é¡µæ—¶ï¼Œè°ƒç”¨åå° API åŠ è½½å•†å“æ•°æ®çš„æ­¥éª¤éœ€è¦æ”¾åˆ°é’©å­å‡½æ•°ä¸­ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¾èµ–åˆ—è¡¨ï¼Œå½“ä¾èµ–çš„å¯¹è±¡å‘ç”Ÿå˜åŒ–(Object Identity)æ—¶ React éƒ½ä¼šæ‰§è¡Œä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‡½æ•°æ›´æ–°ç»„ä»¶ã€‚

``` js
const CartPage = () => {
  const [cart, setCart] = React.useState(null);
  const router = useRouter();
  useEffect(() => {
    if (!router.isReady) { return; }
    server.getCart(router.query.cid).then(cart => setCart(cart));
  }, [router]);


  if (!cart) {
    return <div className="w-fit mt-12"><Loading width={64} height={64} /></div>;
  }

  return (
    <div>
      {cart.items?.map(item => <Item key={item.id} item={item} />)}
    </div>
  );
};
```

æˆ–è€…é¡µé¢å€’è®¡æ—¶ï¼Œåœ¨ `React.useEffect()` ç¬¬ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ä¸­ï¼Œå¯ä»¥è¿”å›ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œç”¨ä½œ clean up.

``` js

const Home = () => {
  const [countdown, setCountdown] = React.useState(60);

  React.useEffect(() => {
    let countdownInterval = setInterval(() => {
      if (countdown > 0) {
        setCountdown(countdown => countdown - 1);
      } else {
        setCountdown(null);
      }
    }, 1000);
    return () => { clearInterval(countdownInterval); };
  }, [countdown]);

  return (
    <div>
        {countdown ? countdown + "s" :  "done" }
    </div>
};
```

## **åº”ç”¨å±•ç¤º**

æ’‘æ¡äº†ä¸Šé¢çš„åŸºç¡€çŸ¥è¯†åŠ ä¸Šä¸€äº›ç»†èŠ‚ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åšä¸€ä¸ª Web ç«¯çš„å…±äº«è´­ç‰©è½¦åº”ç”¨äº†ã€‚

![åº”ç”¨å±•ç¤º](../images/cartcart_presentation.jpg)